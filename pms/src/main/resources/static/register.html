
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Register - ParkEasy</title>
    <!-- Bootstrap CSS -->
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
            rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
        :root {
          --primary-color: #3498db;
          --secondary-color: #2c3e50;
          --accent-color: #e74c3c;
          --light-color: #ecf0f1;
          --dark-color: #34495e;
        }

        body {
          font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          min-height: 100vh;
          margin: 0;
          padding: 0;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .register-container {
          width: 100%;
          max-width: 500px;
          background: rgba(255, 255, 255, 0.15);
          backdrop-filter: blur(10px);
          border-radius: 15px;
          padding: 2rem;
          box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
          border: 1px solid rgba(255, 255, 255, 0.2);
        }

        #passwordStrengthBar {
            height: 10px;
            border-radius: 5px;
            background-color: #e0e0e0;
            margin-top: 5px;
            overflow: hidden;
        }

        #passwordStrengthBar span {
            display: block;
            height: 100%;
            border-radius: 5px;
        }

        .password-hint {
            font-size: 12px;
            color: #f8f9fa;
            margin-top: 5px;
        }
    </style>
</head>
<body>
<div class="register-container">
    <div class="register-header">
        <h2>Create Account</h2>
        <p>Join ParkEasy and start booking parking slots today</p>
    </div>

    <div id="alertContainer"></div>

    <button id="backToHomeBtn" type="button" class="btn btn-outline-light mb-3">
        <i class="fas fa-home me-1"></i> Back to Home
    </button>

    <form id="registerForm">
        <div class="mb-3">
            <label for="fullName" class="form-label">Full Name</label>
            <input type="text" class="form-control" id="fullName" placeholder="Full Name" required />
        </div>

        <div class="mb-3">
            <label for="username" class="form-label">Username</label>
            <input type="text" class="form-control" id="username" placeholder="Username" required />
        </div>

        <div class="mb-3">
            <label for="email" class="form-label">Email address</label>
            <input type="email" class="form-control" id="email" placeholder="Enter email" required />
        </div>

        <div class="mb-3">
            <label for="phoneNumber" class="form-label">Phone Number</label>
            <input type="tel" class="form-control" id="phoneNumber" placeholder="Phone Number" required />
        </div>

        <div class="mb-3">
            <label for="password" class="form-label">Password</label>
            <div style="position:relative;">
                <input type="password" class="form-control" id="password" placeholder="Password" minlength="8" required />
                <button type="button" id="togglePassword" tabindex="-1" style="position:absolute; right:10px; top:50%; transform:translateY(-50%); background:none; border:none; color:#3498db; font-size:1.1rem;">
                    <i class="fa fa-eye"></i>
                </button>
            </div>
            <div id="passwordStrengthBar"></div>
            <small id="passwordStrengthText" class="form-text text-light"></small>
            <div class="password-hint">
                Password must contain: uppercase, lowercase, number, special character, and at least 8 characters.
            </div>
        </div>

        <div class="mb-3">
            <label for="confirmPassword" class="form-label">Confirm Password</label>
            <div style="position:relative;">
                <input type="password" class="form-control" id="confirmPassword" placeholder="Confirm Password" minlength="8" required />
                <button type="button" id="toggleConfirmPassword" tabindex="-1" style="position:absolute; right:10px; top:50%; transform:translateY(-50%); background:none; border:none; color:#3498db; font-size:1.1rem;">
                    <i class="fa fa-eye"></i>
                </button>
            </div>
        </div>


        <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="terms" required />
            <label class="form-check-label" for="terms">
                I agree to the Terms of Service and Privacy Policy
            </label>
        </div>

        <button type="submit" class="btn btn-primary w-100">
            <i class="fas fa-user-plus me-2"></i> Create Account
        </button>
    </form>
</div>

<!-- Bootstrap Bundle JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

<script>
    const registerForm = document.getElementById("registerForm");
    const alertContainer = document.getElementById("alertContainer");
    const passwordInput = document.getElementById("password");
    const confirmPasswordInput = document.getElementById("confirmPassword");
    const togglePassword = document.getElementById("togglePassword");
    const toggleConfirmPassword = document.getElementById("toggleConfirmPassword");
    const passwordStrengthBar = document.getElementById("passwordStrengthBar");
    const passwordStrengthText = document.getElementById("passwordStrengthText");

    function showAlert(message, type) {
      alertContainer.innerHTML = `
        <div class="alert alert-${type} alert-dismissible fade show" role="alert">
          <i class="fas fa-exclamation-circle me-2"></i>
          ${message}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      `;
    }

    function checkPasswordStrength(password) {
        let strength = 0;
        if (password.length >= 8) strength++;
        if (/[a-z]/.test(password) && /[A-Z]/.test(password)) strength++;
        if (/\d/.test(password)) strength++;
        if (/[@$!%*?&]/.test(password)) strength++;

        let color = "red";
        let width = (strength / 4) * 100;
        let text = "Weak";

        if (strength === 1) { color = "red"; text = "Very Weak"; }
        else if (strength === 2) { color = "orange"; text = "Weak"; }
        else if (strength === 3) { color = "yellowgreen"; text = "Medium"; }
        else if (strength === 4) { color = "green"; text = "Strong"; }

        passwordStrengthBar.innerHTML = `<span style="width:${width}%; background-color:${color};"></span>`;
        passwordStrengthText.textContent = text;
        return strength;
    }

    // Back to Home button
    document.getElementById("backToHomeBtn").onclick = function () {
        window.location.href = "index.html";
    };

    // Password show/hide togglers
    togglePassword.addEventListener("click", function () {
        let type = passwordInput.type === "password" ? "text" : "password";
        passwordInput.type = type;
        togglePassword.innerHTML = type === "text" ? '<i class="fa fa-eye-slash"></i>' : '<i class="fa fa-eye"></i>';
    });

    toggleConfirmPassword.addEventListener("click", function () {
        let type = confirmPasswordInput.type === "password" ? "text" : "password";
        confirmPasswordInput.type = type;
        toggleConfirmPassword.innerHTML = type === "text" ? '<i class="fa fa-eye-slash"></i>' : '<i class="fa fa-eye"></i>';
    });

    // Password strength checker
    passwordInput.addEventListener("input", () => {
        checkPasswordStrength(passwordInput.value);
    });

    // Form submission
    registerForm.addEventListener("submit", function (e) {
      e.preventDefault();

      const fullName = document.getElementById("fullName").value.trim();
      const username = document.getElementById("username").value.trim();
      const email = document.getElementById("email").value.trim();
      const phoneNumber = document.getElementById("phoneNumber").value.trim();
      const password = document.getElementById("password").value;
      const confirmPassword = document.getElementById("confirmPassword").value;
      const termsChecked = document.getElementById("terms").checked;

      if (!termsChecked) {
        showAlert("You must agree to the terms.", "danger");
        return;
      }

      if (password !== confirmPassword) {
        showAlert("Passwords do not match.", "danger");
        return;
      }

      const strength = checkPasswordStrength(password);
      if (strength < 3) {
        showAlert("Password is too weak. Make it stronger.", "danger");
        return;
      }

      const data = { fullName, username, email, phoneNumber, password };

      fetch("http://localhost:8080/api/user/register", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data),
      })
      .then(res => res.json())
      .then(resData => {
          if (resData.success || resData.userId) {
              showAlert(resData.message || "Registration successful!", "success");
              setTimeout(() => { window.location.href = "login.html"; }, 2000);
          } else {
              showAlert(resData.message || "Registration failed.", "danger");
          }
      })
      .catch(error => {
          showAlert("Error during registration. Please try again.", "danger");
          console.error("Registration error:", error);
      });
    });
</script>

</body>
</html>

