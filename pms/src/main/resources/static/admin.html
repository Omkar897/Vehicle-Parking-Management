<!-- admin.html -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - ParkEasy</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap-Select CSS -->
    <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/css/bootstrap-select.min.css">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Custom CSS -->

    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --info-color: #9b59b6;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
            color: #333;
        }

        .navbar {
            background: rgba(44, 62, 80, 0.95) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.8rem;
            color: var(--light-color) !important;
        }

        .navbar-brand span {
            color: var(--primary-color);
        }

        .nav-link {
            color: var(--light-color) !important;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-link:hover {
            color: var(--primary-color) !important;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 50%;
            background-color: var(--primary-color);
            transition: all 0.3s ease;
        }

        .nav-link:hover::after {
            width: 100%;
            left: 0;
        }

        .admin-container {
            padding: 3rem 0;
        }

        .dashboard-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .dashboard-title {
            color: white;
            font-weight: 700;
            font-size: 2.2rem;
        }

        .admin-info {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
        }

        .admin-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
            margin-right: 1rem;
        }

        .admin-details h4 {
            color: white;
            margin-bottom: 0.5rem;
        }

        .admin-details p {
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 0.2rem;
            font-size: 0.95rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-bottom: 1.5rem;
            transition: all 0.3s ease;
            overflow: hidden;
            color: white;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .card-header {
            background-color: rgba(255, 255, 255, 0.05);
            padding: 1rem 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            color: white;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
        }

        .card-title i {
            margin-right: 0.5rem;
            color: var(--primary-color);
        }

        .card-body {
            padding: 1.5rem;
        }

        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background-color: #2980b9;
            border-color: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn-outline-light {
            border-color: var(--light-color);
            color: var(--light-color);
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-outline-light:hover {
            background-color: var(--light-color);
            color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(236, 240, 241, 0.4);
        }

        .btn-danger {
            background-color: var(--accent-color);
            border-color: var(--accent-color);
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-danger:hover {
            background-color: #c0392b;
            border-color: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }

        .btn-success {
            background-color: var(--success-color);
            border-color: var(--success-color);
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-success:hover {
            background-color: #219653;
            border-color: #219653;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.4);
        }

        .btn-warning {
            background-color: var(--warning-color);
            border-color: var(--warning-color);
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-warning:hover {
            background-color: #e67e22;
            border-color: #e67e22;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.4);
        }

        .btn-info {
            background-color: var(--info-color);
            border-color: var(--info-color);
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-info:hover {
            background-color: #8e44ad;
            border-color: #8e44ad;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(155, 89, 182, 0.4);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .stat-card {
            text-align: center;
            padding: 1.5rem;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.9;
        }

        .bg-primary-stat {
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid rgba(52, 152, 219, 0.3);
        }

        .bg-success-stat {
            background: rgba(46, 204, 113, 0.2);
            border: 1px solid rgba(46, 204, 113, 0.3);
        }

        .bg-warning-stat {
            background: rgba(243, 156, 18, 0.2);
            border: 1px solid rgba(243, 156, 18, 0.3);
        }

        .bg-info-stat {
            background: rgba(155, 89, 182, 0.2);
            border: 1px solid rgba(155, 89, 182, 0.3);
        }

        .table {
            color: white;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            overflow: hidden;
        }

        .table thead {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .table th {
            border-top: none;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .table td,
        .table th {
            border-color: rgba(255, 255, 255, 0.1);
            vertical-align: middle;
        }

        .table tbody tr {
            transition: all 0.3s ease;
        }

        .table tbody tr:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .badge {
            padding: 0.5em 0.8em;
            border-radius: 20px;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.8em;
        }

        .badge-success {
            background-color: rgba(46, 204, 113, 0.2);
            color: #27ae60;
        }

        .badge-danger {
            background-color: rgba(231, 76, 60, 0.2);
            color: #e74c3c;
        }

        .badge-warning {
            background-color: rgba(243, 156, 18, 0.2);
            color: #f39c12;
        }

        .badge-info {
            background-color: rgba(52, 152, 219, 0.2);
            color: #3498db;
        }

        .action-buttons .btn {
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .action-buttons .btn:last-child {
            margin-right: 0;
        }

        .form-label {
            color: rgba(255, 255, 255, 0.9);
            font-weight: 500;
        }

        .form-control,
        .form-select {
            background-color: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            border-radius: 8px;
            padding: 10px 15px;
        }

        .form-control::placeholder,
        .form-select {
            color: rgba(255, 255, 255, 0.7);
        }

        .form-control:focus,
        .form-select:focus {
            background-color: rgba(255, 255, 255, 0.3);
            border-color: var(--primary-color);
            color: white;
            box-shadow: none;
        }

        .form-floating>label {
            color: rgba(255, 255, 255, 0.7);
        }

        .alert {
            border-radius: 8px;
            margin-bottom: 1rem;
            padding: 1rem;
            display: none;
        }

        .alert-success {
            background-color: rgba(40, 167, 69, 0.2);
            border: 1px solid rgba(40, 167, 69, 0.3);
            color: #28a745;
        }

        .alert-danger {
            background-color: rgba(220, 53, 69, 0.2);
            border: 1px solid rgba(220, 53, 69, 0.3);
            color: #dc3545;
        }

        .alert-info {
            background-color: rgba(0, 123, 255, 0.2);
            border: 1px solid rgba(0, 123, 255, 0.3);
            color: #007bff;
        }

        .alert-show {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-content {
            background: rgba(44, 62, 80, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
        }

        .modal-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
        }

        .modal-title {
            color: white;
            font-weight: 600;
        }

        .modal-body {
            padding: 1.5rem;
            color: rgba(255, 255, 255, 0.9);
        }

        .modal-footer {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 1.5rem;
        }

        .progress {
            height: 10px;
            border-radius: 5px;
            background-color: rgba(255, 255, 255, 0.1);
        }

        .progress-bar {
            border-radius: 5px;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin: 2rem 0;
        }

        /* Responsive adjustments */
        @media (max-width: 767.98px) {
            .admin-details {
                text-align: center;
                margin-bottom: 1rem;
            }

            .admin-avatar {
                margin: 0 auto 1rem auto;
                display: block;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .action-buttons {
                text-align: center;
            }

            .action-buttons .btn {
                margin-right: 0;
                margin-bottom: 0.5rem;
            }

            .modal-content select,
            .modal-content option {
                color: #222 !important;
                /* dark text */
                background-color: #fff !important;
                /* white background */
            }
        }

        .bootstrap-select .dropdown-toggle,
        .bootstrap-select>.dropdown-toggle {
            height: 48px !important;
            /* Match your input box height */
            border-radius: 8px !important;
            /* Rounded corners same as .form-control */
            background-color: rgba(255, 255, 255, 0.2) !important;
            /* Modal input background */
            border: 1px solid rgba(255, 255, 255, 0.3) !important;
            /* Modal input border */
            color: #fff !important;
            /* Text color as modal inputs */
            padding: 10px 15px !important;
            /* Padding same as .form-control */
            font-size: 1rem !important;
            /* Match font size for consistency */
            font-family: inherit !important;
            /* Match font family */
            box-shadow: none !important;
            /* Remove unwanted dropdown inset shadow */
        }

        .bootstrap-select .dropdown-toggle:focus,
        .bootstrap-select>.dropdown-toggle:focus {
            background-color: rgba(255, 255, 255, 0.3) !important;
            border-color: #3498db !important;
            /* Match focused border */
            color: #fff !important;
            outline: none !important;
        }

        .bootstrap-select .dropdown-menu {
            background-color: #fff;
            color: #222;
            border-radius: 8px;
            font-size: 1rem;
        }

        /* For option text coloring in dropdown if needed (optional) */
        .bootstrap-select .dropdown-menu .dropdown-item {
            color: #222 !important;
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-parking"></i> Park<span>Easy</span>
            </a>

            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/"><i class="fas fa-home"></i> Home</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/manage-users.html">Manage Users</a>
                    </li>

                    <li class="nav-item">
                        <a class="nav-link" href="/#about"><i class="fas fa-info-circle"></i> About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/#contact"><i class="fas fa-envelope"></i> Contact</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/admin.html"><i class="fas fa-user-shield"></i> Admin</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" id="logoutLink"><i class="fas fa-sign-out-alt"></i> Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Admin Dashboard -->
    <div class="admin-container">
        <div class="container">
            <div class="dashboard-header">
                <h1 class="dashboard-title">Admin Dashboard</h1>
                <p class="text-white-50">Manage parking system and monitor operations</p>
            </div>

            <!-- Admin Info -->
            <div class="admin-info">
                <img src="https://ui-avatars.com/api/?name=Admin+User&background=d35400&color=fff&size=128"
                    alt="Admin Avatar" class="admin-avatar">
                <div class="admin-details">
                    <h4 id="adminName">Admin User</h4>
                    <p><i class="fas fa-envelope me-2"></i> <span id="adminEmail">admin@parkeasy.com</span></p>
                </div>
            </div>

            <!-- Dashboard Stats -->
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-tachometer-alt"></i> System Overview
                    </h5>
                    <button class="btn btn-sm btn-outline-light" id="refreshSystemOverview">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                </div>
                <div id="systemOverviewAlertContainer"></div>

                <div class="card-body">
                    <div class="stats-grid">
                        <div class="stat-card bg-primary-stat">
                            <div class="stat-number" id="totalSlots">30</div>
                            <div class="stat-label">Total Slots</div>
                        </div>
                        <div class="stat-card bg-success-stat">
                            <div class="stat-number" id="availableSlots">15</div>
                            <div class="stat-label">Available Slots</div>
                        </div>
                        <div class="stat-card bg-danger-stat">
                            <div class="stat-number" id="occupiedSlots">15</div>
                            <div class="stat-label">Occupied Slots</div>
                        </div>
                        <div class="stat-card bg-info-stat">
                            <div class="stat-number" id="totalBookings">127</div>
                            <div class="stat-label">Total Bookings</div>
                        </div>
                        <div class="stat-card bg-warning-stat">
                            <div class="stat-number" id="todayBookings">18</div>
                            <div class="stat-label">Today's Bookings</div>
                        </div>

                        <div class="stat-card bg-primary-stat">
                            <div class="stat-number">â‚¹<span id="totalRevenue"></span></div>
                            <div class="stat-label">Total Revenue</div>
                        </div>

                    </div>

                    <div class="mt-4">
                        <h6>Occupancy Rate</h6>
                        <div class="progress">
                            <div class="progress-bar bg-primary" role="progressbar" style="width: 50%;"
                                aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">50%</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-8">
                    <!-- Recent Bookings -->
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="card-title mb-0"><i class="fas fa-ticket-alt"></i> Recent Bookings</h5>
                            <button class="btn btn-sm btn-outline-light" id="refreshBookings">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                        </div>
                        <div class="card-body">
                            <!-- Alert messages -->
                            <div id="bookingsAlertContainer"></div>

                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>User</th>
                                            <th>Slot</th>
                                            <th>Vehicle</th>
                                            <th>Entry Time</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bookingsTableBody">
                                        <!-- Data will be populated here -->
                                        <tr>
                                            <td colspan="7" class="text-center text-white-50">Loading bookings...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Parking Slots Management -->
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-parking"></i> Parking Slots
                            </h5>
                            <div>
                                <button class="btn btn-sm btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#addSlotModal">
                                    <i class="fas fa-plus"></i> Add Slot
                                </button>
                                <button class="btn btn-sm btn-outline-light ms-2" id="refreshSlots">
                                    <i class="fas fa-sync"></i> Refresh
                                </button>
                            </div>
                        </div>

                        <div class="card-body">
                            <!-- Alert messages -->
                            <div id="slotsAlertContainer"></div>

                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Slot Number</th>
                                            <th>Vehicle Type</th>
                                            <th>Hourly Rate</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="slotsTableBody">
                                        <!-- Data will be populated here -->
                                        <tr>
                                            <td colspan="5" class="text-center text-white-50">Loading slots...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-4">
                    <!-- Vehicle Statistics -->
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-chart-bar"></i> Vehicle Statistics
                            </h5>
                            <button class="btn btn-sm btn-outline-light" id="refreshVehicleStats">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                        </div>
                        <div id="vehicleStatsAlertContainer"></div>


                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <div><i class="fas fa-motorcycle me-2"></i> Two Wheelers</div>
                                <div>
                                    <span id="twoWheelerCount">10</span>/<span id="twoWheelerTotal">10</span>
                                </div>
                            </div>
                            <div class="progress mb-4">
                                <div class="progress-bar bg-info" id="barTwoWheeler" role="progressbar"
                                    style="width: 100%;" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">
                                </div>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <div><i class="fas fa-truck-pickup me-2"></i> Three Wheelers</div>
                                <div>
                                    <span id="threeWheelerCount">5</span>/<span id="threeWheelerTotal">5</span>
                                </div>
                            </div>
                            <div class="progress mb-4">
                                <div class="progress-bar bg-warning" id="barThreeWheeler" role="progressbar"
                                    style="width: 100%;" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">
                                </div>
                            </div>
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <div><i class="fas fa-car me-2"></i> Four Wheelers</div>
                                <div>
                                    <span id="fourWheelerCount">15</span>/<span id="fourWheelerTotal">15</span>
                                </div>
                            </div>
                            <div class="progress mb-4">
                                <div class="progress-bar bg-primary" id="barFourWheeler" role="progressbar"
                                    style="width: 100%;" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">
                                </div>
                            </div>
                            <div class="d-flex justify-content-between align-items-center">
                                <div><i class="fas fa-plug me-2"></i> EV Charging</div>
                                <div>
                                    <span id="evCount">5</span>/<span id="evTotal">5</span>
                                </div>
                            </div>
                            <div class="progress">
                                <div class="progress-bar bg-success" id="barEV" role="progressbar" style="width: 100%;"
                                    aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                        </div>
                    </div>


                    <!-- Quick Actions -->
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title"><i class="fas fa-bolt"></i> Quick Actions</h5>
                        </div>
                        <div class="card-body action-buttons">
                            <button class="btn btn-outline-light w-100 mb-2" data-bs-toggle="modal"
                                data-bs-target="#addSlotModal">
                                <i class="fas fa-plus-circle me-2"></i> Add Parking Slot
                            </button>
                            <button class="btn btn-outline-light w-100 mb-2" id="manageUsers">
                                <i class="fas fa-users-cog me-2"></i> Manage Users
                            </button>

                            <a href="admin-reports.html" class="btn btn-outline-light w-100 mb-2">
                                <i class="fas fa-file-invoice-dollar me-2"></i> View Reports
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Slot Modal -->
    <div class="modal fade" id="addSlotModal" tabindex="-1" aria-labelledby="addSlotModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addSlotModalLabel">Add New Parking Slot</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addSlotForm">
                        <div class="mb-3">
                            <label for="slotNumber" class="form-label">Slot Number</label>
                            <input type="text" class="form-control" id="slotNumber" placeholder="e.g. A1, B2" required>
                        </div>
                        <div class="mb-3">
                            <label for="vehicleType" class="form-label">Vehicle Type</label>
                            <select class="selectpicker form-control" data-style="btn-light" id="vehicleType" required>
                                <option value="">Select Vehicle Type</option>
                                <option value="TWO_WHEELER">Two Wheeler (Bike)</option>
                                <option value="THREE_WHEELER">Three Wheeler</option>
                                <option value="FOUR_WHEELER">Four Wheeler (Car)</option>
                                <option value="EV">Electric Vehicle</option>
                            </select>

                        </div>
                        <div class="mb-3">
                            <label for="bookingTime" class="form-label">Booking Entry Time</label>
                            <input type="datetime-local" class="form-control" id="bookingTime" required>
                        </div>

                        <div class="mb-3">
                            <label for="hourlyRate" class="form-label">Hourly Rate (â‚¹)</label>
                            <input type="number" class="form-control" id="hourlyRate" step="0.01" min="1" required>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="isAvailable" checked>
                            <label class="form-check-label" for="isAvailable">
                                Slot is available
                            </label>
                        </div>
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            New slots are automatically available unless specified otherwise.
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveSlot">Save Slot</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Slot Modal -->
    <div class="modal fade" id="editSlotModal" tabindex="-1" aria-labelledby="editSlotModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editSlotModalLabel">Edit Parking Slot</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editSlotForm">
                        <input type="hidden" id="editSlotId">
                        <div class="mb-3">
                            <label for="editSlotNumber" class="form-label">Slot Number</label>
                            <input type="text" class="form-control" id="editSlotNumber" required>
                        </div>
                        <div class="mb-3">
                            <label for="editVehicleType" class="form-label">Vehicle Type</label>
                            <select class="selectpicker form-control" data-style="btn-light" id="editVehicleType"
                                required>
                                <option value="TWO_WHEELER">Two Wheeler (Bike)</option>
                                <option value="THREE_WHEELER">Three Wheeler</option>
                                <option value="FOUR_WHEELER">Four Wheeler (Car)</option>
                                <option value="EV">Electric Vehicle</option>
                            </select>
                        </div>

                        <div class="mb-3">
                            <label for="editHourlyRate" class="form-label">Hourly Rate (â‚¹)</label>
                            <input type="number" class="form-control" id="editHourlyRate" step="0.01" min="1" required>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="editIsAvailable">
                            <label class="form-check-label" for="editIsAvailable">
                                Slot is available
                            </label>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="updateSlot">Update Slot</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Update Booking Status Modal -->
    <div class="modal fade" id="statusModal" tabindex="-1" aria-labelledby="statusModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="statusModalLabel">Update Booking Status</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p><strong>Booking ID:</strong> <span id="statusBookingId">12345</span></p>
                    <p><strong>User:</strong> <span id="statusUser">John Doe</span></p>
                    <p><strong>Slot:</strong> <span id="statusSlot">A1</span></p>
                    <p><strong>Current Status:</strong> <span id="currentStatus" class="badge badge-info">BOOKED</span>
                    </p>

                    <div class="mt-3">
                        <label for="newStatus" class="form-label">Select New Status</label>
                        <select class="selectpicker form-control" data-style="btn-light" id="newStatus">
                            <option value="BOOKED">BOOKED</option>
                            <option value="COMPLETED">COMPLETED</option>
                            <option value="CANCELLED">CANCELLED</option>
                        </select>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="updateStatus">Update Status</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Slot Modal -->
    <div class="modal fade" id="deleteSlotModal" tabindex="-1" aria-labelledby="deleteSlotModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deleteSlotModalLabel">Delete Parking Slot</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete parking slot <strong id="deleteSlotNumber">A1</strong>?</p>
                    <p class="text-danger"><i class="fas fa-exclamation-triangle me-2"></i> This action cannot be
                        undone. Only slots without active bookings can be deleted.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-danger" id="confirmDelete">Delete Slot</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Chart.js for charts (optional) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>


    <!-- Bootstrap-Select JS (ADD THIS HERE) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta3/dist/js/bootstrap-select.min.js"></script>
    <script>
        $(document).ready(function () {
            $('.selectpicker').selectpicker();
        });
    </script>

    <!-- Custom JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // ðŸŽ¯ RAILWAY URL CONFIGURATION
            const BASE_URL = 'https://vehicle-parking-management-production.up.railway.app';

            // DOM elements
            const adminName = document.getElementById('adminName');
            const adminEmail = document.getElementById('adminEmail');

            const totalSlots = document.getElementById('totalSlots');
            const availableSlots = document.getElementById('availableSlots');
            const occupiedSlots = document.getElementById('occupiedSlots');
            const totalBookings = document.getElementById('totalBookings');
            const todayBookings = document.getElementById('todayBookings');
            const totalRevenue = document.getElementById('totalRevenue');
            const vehicleStatsAlertContainer = document.getElementById('vehicleStatsAlertContainer');

            const twoWheelerCount = document.getElementById('twoWheelerCount');
            const twoWheelerTotal = document.getElementById('twoWheelerTotal');
            const threeWheelerCount = document.getElementById('threeWheelerCount');
            const threeWheelerTotal = document.getElementById('threeWheelerTotal');
            const fourWheelerCount = document.getElementById('fourWheelerCount');
            const fourWheelerTotal = document.getElementById('fourWheelerTotal');
            const evCount = document.getElementById('evCount');
            const evTotal = document.getElementById('evTotal');
            const bookingTimeInput = document.getElementById('bookingTime');

            if (bookingTimeInput) {
                const now = new Date();
                bookingTimeInput.min = now.toISOString().slice(0, 16); // YYYY-MM-DDTHH:mm
            }
            const bookingsTableBody = document.getElementById('bookingsTableBody');
            const slotsTableBody = document.getElementById('slotsTableBody');

            const bookingsAlertContainer = document.getElementById('bookingsAlertContainer');
            const slotsAlertContainer = document.getElementById('slotsAlertContainer');
            const systemOverviewAlertContainer = document.getElementById('systemOverviewAlertContainer');

            const refreshBookings = document.getElementById('refreshBookings');
            const manageUsers = document.getElementById('manageUsers');
            const viewReports = document.getElementById('viewReports');
            const systemSettings = document.getElementById('systemSettings');
            const logoutLink = document.getElementById('logoutLink');

            // Modal elements
            const addSlotModal = document.getElementById('addSlotModal');
            const editSlotModal = document.getElementById('editSlotModal');
            const statusModal = document.getElementById('statusModal');
            const deleteSlotModal = document.getElementById('deleteSlotModal');

            const addSlotForm = document.getElementById('addSlotForm');
            const editSlotForm = document.getElementById('editSlotForm');
            const statusForm = document.getElementById('statusForm');

            const slotNumber = document.getElementById('slotNumber');
            const vehicleType = document.getElementById('vehicleType');
            const hourlyRate = document.getElementById('hourlyRate');
            const isAvailable = document.getElementById('isAvailable');

            const editSlotId = document.getElementById('editSlotId');
            const editSlotNumber = document.getElementById('editSlotNumber');
            const editVehicleType = document.getElementById('editVehicleType');
            const editHourlyRate = document.getElementById('editHourlyRate');
            const editIsAvailable = document.getElementById('editIsAvailable');

            const statusBookingId = document.getElementById('statusBookingId');
            const statusUser = document.getElementById('statusUser');
            const statusSlot = document.getElementById('statusSlot');
            const currentStatus = document.getElementById('currentStatus');
            const newStatus = document.getElementById('newStatus');

            const deleteSlotNumber = document.getElementById('deleteSlotNumber');
            const saveSlotBtn = document.getElementById('saveSlot');
            const updateSlotBtn = document.getElementById('updateSlot');
            const updateStatusBtn = document.getElementById('updateStatus');
            const confirmDeleteBtn = document.getElementById('confirmDelete');

            // Load admin data dynamically from localStorage
            const storedAdmin = localStorage.getItem('adminUser');
            if (storedAdmin) {
                try {
                    const currentAdmin = JSON.parse(storedAdmin);
                    setAdminData(currentAdmin);
                } catch (e) {
                    // If JSON parsing error, redirect to login
                    window.location.href = 'login.html'; // Adjust as per your login page
                    return;
                }
            } else {
                // No admin logged in, redirect to login page
                window.location.href = 'login.html'; // Adjust as per your login page
                return;
            }

            // Set admin data function
            function setAdminData(admin) {
                adminName.textContent = admin.fullName || admin.username || 'Admin User';
                adminEmail.textContent = admin.email || 'admin@parkeasy.com';
            }

            // Show alert function remains unchanged
            function showAlert(container, message, type) {
                container.innerHTML = `
                    <div class="alert alert-${type} alert-show">
                        <i class="fas fa-exclamation-circle me-2"></i>
                        ${message}
                    </div>
                `;

                // Hide alert after 5 seconds
                setTimeout(() => {
                    const alert = container.querySelector('.alert');
                    if (alert) {
                        alert.classList.remove('alert-show');
                        setTimeout(() => {
                            alert.remove();
                        }, 500);
                    }
                }, 5000);
            }

            // Format date and time
            function formatDateTime(dateTimeStr) {
                const date = new Date(dateTimeStr);
                return date.toLocaleString('en-US', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }

            // Populate dashboard stats
            function populateStats() {
                fetch(`${BASE_URL}/api/admin/dashboard/stats`)
                    .then(response => response.json())
                    .then(stats => {
                        totalSlots.textContent = stats.totalSlots;
                        availableSlots.textContent = stats.availableSlots;
                        occupiedSlots.textContent = stats.occupiedSlots;
                        totalBookings.textContent = stats.totalBookings;
                        todayBookings.textContent = stats.todayBookings;

                        // Skip revenue update for now if you want
                        // totalRevenue.textContent = `$${stats.totalRevenue}`;

                        const occupancyPercent = stats.totalSlots > 0
                            ? (stats.occupiedSlots / stats.totalSlots) * 100
                            : 0;
                        const progressBar = document.querySelector('.progress-bar');
                        progressBar.style.width = occupancyPercent + '%';
                        progressBar.textContent = occupancyPercent.toFixed(0) + '%';
                    })
                    .catch(error => {
                        console.error('Failed to load dashboard stats:', error);
                        showAlert(slotsAlertContainer, 'Failed to load dashboard statistics', 'danger');
                    });
            }

            function populateVehicleStats() {
                fetch(`${BASE_URL}/api/admin/dashboard/stats`)
                    .then(response => {
                        if (!response.ok) throw new Error('API failed');
                        return response.json();
                    })
                    .then(stats => {
                        twoWheelerCount.textContent = stats.availableTwoWheelerSlots ?? 0;
                        threeWheelerCount.textContent = stats.availableThreeWheelerSlots ?? 0;
                        fourWheelerCount.textContent = stats.availableFourWheelerSlots ?? 0;
                        evCount.textContent = stats.availableEvSlots ?? 0;
                        twoWheelerTotal.textContent = stats.twoWheelerSlots ?? 0;
                        threeWheelerTotal.textContent = stats.threeWheelerSlots ?? 0;
                        fourWheelerTotal.textContent = stats.fourWheelerSlots ?? 0;
                        evTotal.textContent = stats.evSlots ?? 0;

                        const calcPercent = (available, total) => total > 0 ? (available / total * 100).toFixed(0) : 0;

                        // Two Wheelers
                        const bar2w = document.querySelector('.progress-bar.bg-info');
                        if (bar2w)
                            bar2w.style.width = calcPercent(stats.availableTwoWheelerSlots, stats.twoWheelerSlots) + '%';

                        // Three Wheelers
                        const bar3w = document.querySelector('.progress-bar.bg-warning');
                        if (bar3w)
                            bar3w.style.width = calcPercent(stats.availableThreeWheelerSlots, stats.threeWheelerSlots) + '%';

                        // Four Wheelers
                        const bar4w = document.getElementById('barFourWheeler');
                        if (bar4w) {
                            const percent = calcPercent(stats.availableFourWheelerSlots, stats.fourWheelerSlots);
                            bar4w.style.width = percent + '%';
                        }

                        // EV Charging
                        const barEv = document.querySelector('.progress-bar.bg-success');
                        if (barEv)
                            barEv.style.width = calcPercent(stats.availableEvSlots, stats.evSlots) + '%';
                    })
                    .catch(error => {
                        console.error('Failed to load vehicle stats:', error);
                        showAlert(slotsAlertContainer, 'Failed to load vehicle statistics.', 'danger');
                    });
            }

            function formatDateTime(dateArray) {
                // Handle array format from LocalDateTime
                if (Array.isArray(dateArray) && dateArray.length >= 5) {
                    // dateArray format: [year, month, day, hour, minute]
                    const [year, month, day, hour, minute] = dateArray;
                    const date = new Date(year, month - 1, day, hour, minute); // month is 0-indexed in JS

                    return date.toLocaleString('en-US', {
                        year: 'numeric',
                        month: 'short',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit',
                        hour12: true
                    });
                }

                // Fallback for string dates
                return 'Invalid Date';
            }

            function updateBookingStatus() {
                const bookingId = statusBookingId.textContent.replace('#', '');
                const newStatusValue = newStatus.value;

                fetch(`${BASE_URL}/api/admin/bookings/status`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        bookingId: bookingId,
                        status: newStatusValue
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            alert('Booking status updated successfully!');

                            const statusModalInstance = bootstrap.Modal.getInstance(statusModal);
                            statusModalInstance.hide();

                            populateBookingsTable();
                        } else {
                            alert('Error: ' + data.message);
                        }
                    })
                    .catch(error => {
                        console.error('Error updating status:', error);
                        alert('Failed to update booking status');
                    });
            }

            // Populate bookings table
            function populateBookingsTable() {
                fetch(`${BASE_URL}/api/admin/bookings`)
                    .then(response => response.json())
                    .then(bookings => {
                        // Sort by newest entryTime first
                        bookings.sort((a, b) => new Date(b.entryTime) - new Date(a.entryTime));
                        let bookingsHTML = '';
                        bookings.forEach(booking => {
                            const vehicleIcon = booking.vehicleType === 'TWO_WHEELER' ? 'motorcycle' :
                                booking.vehicleType === 'THREE_WHEELER' ? 'truck-pickup' :
                                    booking.vehicleType === 'EV' ? 'plug' : 'car';

                            const userName = booking.user?.fullName || booking.user?.username || `User ${booking.user}` || 'Unknown';
                            const slotNumber = booking.parkingSlot?.slotNumber || 'N/A';

                            bookingsHTML += `
                                <tr>
                                    <td>#${booking.id}</td>
                                    <td><i class="fas fa-user me-2"></i>${userName}</td>
                                    <td>${slotNumber}</td>
                                    <td><i class="fas fa-${vehicleIcon} me-2"></i>${booking.vehicleType.replace('_', ' ')}</td>
                                    <td>${formatDateTime(booking.entryTime)}</td>
                                    <td><span class="badge badge-${booking.status === 'BOOKED' ? 'info' : booking.status === 'COMPLETED' ? 'success' : 'danger'}">${booking.status}</span></td>
                                    <td>
                                        <button class="btn btn-sm btn-info update-status"
                                                data-booking-id="${booking.id}"
                                                data-user="${userName}"
                                                data-slot="${slotNumber}"
                                                data-status="${booking.status}">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </td>
                                </tr>
                            `;
                        });

                        bookingsTableBody.innerHTML = bookingsHTML;

                        // Add event listeners after DOM update
                        document.querySelectorAll('.update-status').forEach(btn => {
                            btn.addEventListener('click', function (e) {
                                console.log('Button clicked!'); // Debug log

                                const bookingId = this.getAttribute('data-booking-id');
                                const user = this.getAttribute('data-user');
                                const slot = this.getAttribute('data-slot');
                                const status = this.getAttribute('data-status');

                                statusBookingId.textContent = '#' + bookingId;
                                statusUser.textContent = user;
                                statusSlot.textContent = slot;
                                currentStatus.textContent = status;
                                currentStatus.className = `badge badge-${status === 'BOOKED' ? 'info' : status === 'COMPLETED' ? 'success' : 'danger'}`;
                                newStatus.value = status;

                                const statusModalInstance = bootstrap.Modal.getOrCreateInstance(statusModal);
                                statusModalInstance.show();
                            });
                        });

                    })
                    .catch(error => {
                        console.error('Error fetching bookings:', error);
                        bookingsTableBody.innerHTML = '<tr><td colspan="7">Failed to load bookings</td></tr>';
                    });
            }

            // Added function: fetch slots dynamically based on vehicle type
            function fetchSlots() {
                fetch(`${BASE_URL}/api/admin/slots`)
                    .then(response => response.json())
                    .then(slots => {
                        renderSlots(slots);
                    })
                    .catch(error => {
                        console.error('Error fetching slots:', error);
                        showAlert(slotsAlertContainer, 'Failed to load slots.', 'danger');
                    });
            }

            // Added function: render slots into the slots table
            function renderSlots(slots) {
                slots.sort((a, b) => {
                    const regex = /^([A-Za-z]+)(\d+)$/;
                    const matchA = a.slotNumber.match(regex);
                    const matchB = b.slotNumber.match(regex);

                    if (matchA && matchB) {
                        if (matchA[1] !== matchB[1]) {
                            return matchA[1].localeCompare(matchB[1]);
                        }
                        return Number(matchA[2]) - Number(matchB[2]);
                    }
                    return a.slotNumber.localeCompare(b.slotNumber, undefined, { numeric: true, sensitivity: 'base' });
                });
                let slotsHTML = '';
                slots.forEach(slot => {
                    const vehicleIcon = slot.vehicleType === 'TWO_WHEELER' ? 'motorcycle' :
                        slot.vehicleType === 'THREE_WHEELER' ? 'truck-pickup' :
                            slot.vehicleType === 'EV' ? 'plug' : 'car';

                    slotsHTML += `
                        <tr>
                            <td>${slot.slotNumber}</td>
                            <td>
                                <i class="fas fa-${vehicleIcon} me-2"></i>
                                ${slot.vehicleType.replace('_', ' ')}
                            </td>
                            <td>â‚¹${slot.hourlyRate.toFixed(2)}/hr</td>
                            <td>
                                 <span class="badge badge-${slot.available ? 'success' : 'danger'}">
                               ${slot.available ? 'AVAILABLE' : 'OCCUPIED'}
                                </span>
                            </td>
                            <td>
                                <button class="btn btn-sm btn-warning edit-slot"
                                    data-id="${slot.id}"
                                    data-number="${slot.slotNumber}"
                                    data-vehicle-type="${slot.vehicleType}"
                                    data-hourly-rate="${slot.hourlyRate}"
                                    data-is-available="${slot.isAvailable}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn btn-sm btn-danger delete-slot"
                                    data-id="${slot.id}"
                                    data-number="${slot.slotNumber}">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                });
                slotsTableBody.innerHTML = slotsHTML;
                addEditDeleteListeners();
            }

            // Extracted from your populateSlotsTable() - add listeners to edit/delete buttons
            // Add event listeners to edit buttons
            function addEditDeleteListeners() {
                console.log('Binding edit/delete listeners');
                document.querySelectorAll('.edit-slot').forEach(btn => {
                    btn.addEventListener('click', function () {
                        const id = this.getAttribute('data-id');
                        const number = this.getAttribute('data-number');
                        const vehicleTypeValue = this.getAttribute('data-vehicle-type');
                        const hourlyRateValue = this.getAttribute('data-hourly-rate');
                        const isAvailableValue = this.getAttribute('data-is-available') === 'true';

                        editSlotId.value = id;
                        editSlotNumber.value = number;
                        editVehicleType.value = vehicleTypeValue;
                        editHourlyRate.value = hourlyRateValue;
                        editIsAvailable.checked = isAvailableValue;

                        const editSlotModalInstance = bootstrap.Modal.getOrCreateInstance(editSlotModal);
                        editSlotModalInstance.show();
                    });
                });

                // Add event listeners to delete buttons
                document.querySelectorAll('.delete-slot').forEach(btn => {
                    btn.addEventListener('click', function () {
                        const id = this.getAttribute('data-id');
                        const number = this.getAttribute('data-number');

                        deleteSlotNumber.textContent = number;
                        confirmDeleteBtn.setAttribute('data-slot-id', id);

                        const deleteSlotModalInstance = bootstrap.Modal.getOrCreateInstance(deleteSlotModal);
                        deleteSlotModalInstance.show();
                    });
                });
            }

            // Modified populateSlotsTable() to load slots from backend using fetchSlots with default vehicle type
            function populateSlotsTable() {
                fetchSlots();
            }

            // Event Listeners
            // Refresh bookings
            refreshBookings.addEventListener('click', function () {
                showAlert(bookingsAlertContainer, 'Data refreshed!', 'info');
                populateBookingsTable();
                populateSlotsTable();
                populateStats();
                populateVehicleStats();
            });

            // Refresh slots
            document.getElementById('refreshSlots').addEventListener('click', function () {
                showAlert(slotsAlertContainer, 'Parking slots refreshed!', 'info');
                populateSlotsTable();    // reload slots data
                populateStats();         // update overall dashboard summary
                populateVehicleStats();  // update vehicle type stats
            });

            // Logout
            logoutLink.addEventListener('click', function (e) {
                e.preventDefault();
                if (confirm('Are you sure you want to logout?')) {
                    // In a real app, this would clear the session and redirect
                    window.location.href = 'index.html';
                }
            });

            // Save new slot
            saveSlotBtn.addEventListener('click', function () {
                const number = slotNumber.value.trim();
                const type = vehicleType.value;
                const rate = parseFloat(hourlyRate.value);
                const available = isAvailable.checked;

                console.log('Saving slot with values:', {
                    slotNumber: number,
                    vehicleType: type,
                    hourlyRate: rate,
                    available: available
                });

                if (!number || !type || isNaN(rate)) {
                    showAlert(slotsAlertContainer, 'Please fill in all fields.', 'danger');
                    return;
                }

                // Real API call to your backend to add the slot
                fetch(`${BASE_URL}/api/admin/slots`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        slotNumber: number,
                        vehicleType: type,
                        hourlyRate: rate,
                        available: available
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            showAlert(slotsAlertContainer, `Parking slot ${number} added successfully!`, 'success');

                            // Close modal
                            bootstrap.Modal.getInstance(addSlotModal).hide();

                            // Reset form fields
                            addSlotForm.reset();
                            isAvailable.checked = true;

                            // Refresh slots table
                            populateSlotsTable();
                        } else {
                            showAlert(slotsAlertContainer, data.message || 'Failed to add parking slot.', 'danger');
                        }
                    })
                    .catch(() => {
                        showAlert(slotsAlertContainer, 'Failed to add parking slot.', 'danger');
                    });
            });

            // ðŸŽ¯ UPDATED SLOT METHOD WITH FIXED ADMIN OVERRIDE
            updateSlotBtn.addEventListener('click', function () {
                const id = editSlotId.value;
                const number = editSlotNumber.value.trim();
                const type = editVehicleType.value;
                const rate = parseFloat(editHourlyRate.value);
                const available = editIsAvailable.checked;

                if (!number || !type || isNaN(rate)) {
                    showAlert(slotsAlertContainer, 'Please fill in all fields correctly.', 'danger');
                    return;
                }

                fetch(`${BASE_URL}/api/admin/slots/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        slotNumber: number,
                        vehicleType: type,
                        hourlyRate: rate,
                        available: available
                    })
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            showAlert(slotsAlertContainer, data.message, 'success');
                            bootstrap.Modal.getInstance(editSlotModal).hide();
                            populateSlotsTable();
                            populateBookingsTable(); // Refresh bookings to see completed status
                            populateStats(); // Refresh stats
                        } else {
                            showAlert(slotsAlertContainer, data.message, 'danger');
                        }
                    })
                    .catch(() => {
                        showAlert(slotsAlertContainer, 'Failed to update parking slot.', 'danger');
                    });
            });

            // Update booking status
            updateStatusBtn.addEventListener('click', updateBookingStatus);

            confirmDeleteBtn.addEventListener('click', function () {
                const slotId = this.getAttribute('data-slot-id');
                const slotNumber = deleteSlotNumber.textContent;

                fetch(`${BASE_URL}/api/admin/slots/${slotId}`, {
                    method: 'DELETE',
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            showAlert(slotsAlertContainer, `Parking slot ${slotNumber} deleted successfully!`, 'success');

                            // Correct modal instance reference
                            const deleteSlotModalInstance = bootstrap.Modal.getInstance(deleteSlotModal);
                            deleteSlotModalInstance.hide();

                            // Refresh slots table and stats
                            populateSlotsTable();
                            populateStats();
                        } else {
                            showAlert(slotsAlertContainer, data.message, 'danger');
                        }
                    })
                    .catch(() => {
                        showAlert(slotsAlertContainer, 'Failed to delete parking slot.', 'danger');
                    });
            });

            function loadTotalRevenue() {
                fetch(`${BASE_URL}/api/admin/dashboard/totalRevenue`)
                    .then(response => response.json())
                    .then(total => {
                        document.getElementById('totalRevenue').textContent = total.toLocaleString();
                    })
                    .catch(() => {
                        document.getElementById('totalRevenue').textContent = 'N/A';
                    });
            }

            var manageUsersBtn = document.getElementById('manageUsers');
            if (manageUsersBtn) {
                manageUsersBtn.addEventListener('click', function () {
                    window.location.href = 'manage-users.html';
                });
            }

            document.getElementById('refreshVehicleStats').addEventListener('click', function () {
                showAlert(vehicleStatsAlertContainer, 'Vehicle statistics refreshed!', 'info');
                populateVehicleStats();
                populateStats(); // optionally update overall stats too
            });

            document.getElementById('refreshSystemOverview').addEventListener('click', function () {
                showAlert(systemOverviewAlertContainer, 'System overview refreshed!', 'info');
                populateStats(); // updates the system overview stats and occupancy rate
            });

            // Initialize the page
            populateStats();
            populateVehicleStats();
            populateBookingsTable();
            populateSlotsTable();
            loadTotalRevenue();

        });
    </script>

</body>

</html>